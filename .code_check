#!/bin/bash

if [ ! -f /.dockerenv ]; then
    echo "This script must be run from inside a docker instance. Run './.shell' to run bash inside the container"
    exit 1
fi

# flake8
./.flake8
if [ $? != 0 ]; then
  echo "Please fix the errors above and commit again."
  exit 1
fi

# tests
export DJANGO_SETTINGS_MODULE=project.settings.test
./manage.py test $@
if [ $? != 0 ]; then
  echo "Please fix the errors above and commit again."
  exit 1
fi
